<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Kinderfreizeit Olympiade â€“ Live</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen font-sans">

<div class="flex flex-col md:flex-row min-h-screen relative">
    
  <div id="clock" class="absolute top-4 right-4 text-2xl md:text-4xl font-mono bg-black/60 px-6 py-3 rounded-xl shadow-lg z-20 border border-gray-700 backdrop-blur-md">
    00:00:00
  </div>

  <div class="w-full md:w-1/2 p-4 md:p-12 flex flex-col justify-center border-b md:border-b-0 md:border-r border-gray-700 relative">
    
    <div id="loading-medals" class="absolute inset-0 flex items-center justify-center bg-gray-900 z-10">
      <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-white"></div>
    </div>

    <h1 class="text-3xl md:text-6xl font-extrabold mb-8 md:mb-12 text-center pt-12 md:pt-0 tracking-tight">
      ğŸ… Medaillenspiegel
    </h1>
    
    <div id="scoreboard" class="space-y-4 md:space-y-6 w-full max-w-md md:max-w-3xl mx-auto transition-all duration-500">
      </div>
  </div>

  <div class="w-full md:w-1/2 bg-gray-800 p-4 md:p-12 flex flex-col justify-center relative">
    <h2 class="text-3xl md:text-5xl font-bold mb-8 md:mb-12 text-center pt-8 md:pt-0 text-gray-200">
      ğŸ“… Tagesablauf
    </h2>
    
    <div id="schedule-list" class="space-y-4 md:space-y-8 text-xl md:text-3xl w-full max-w-md md:max-w-3xl mx-auto">
      <div class="text-center text-gray-400">Lade Termine...</div>
    </div>
  </div>

</div>

<script>
// =================================================================
// ğŸ‘‡ HIER DEINE CSV-LINKS EINFÃœGEN (Zwischen die AnfÃ¼hrungszeichen)
// =================================================================
const URL_MEDAILLEN = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTl8ONEJhICDqDwsal3S1JazhwpI80LhIDD3MdpDiW1T4MJlL8RzX9k4Pq703VY12qRJpzOeZcpD8ZV/pub?gid=0&single=true&output=csv";
const URL_ABLAUF    = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTl8ONEJhICDqDwsal3S1JazhwpI80LhIDD3MdpDiW1T4MJlL8RzX9k4Pq703VY12qRJpzOeZcpD8ZV/pub?gid=1373310417&single=true&output=csv";

// Konfiguration der Farben basierend auf dem Team-Namen im Google Sheet
// Der Name im Sheet muss exakt (oder teilweise) mit dem SchlÃ¼ssel hier Ã¼bereinstimmen.
const colorMap = {
  'blau':    'bg-blue-600 text-white',
  'gelb':    'bg-yellow-400 text-black',
  'schwarz': 'bg-gray-950 text-white border border-gray-600',
  'grÃ¼n':    'bg-green-600 text-white',
  'rot':     'bg-red-600 text-white',
  'orange':  'bg-orange-500 text-white', // Falls mal ein Team dazu kommt
  'weiÃŸ':    'bg-white text-black'
};

// ==========================================
// FUNKTION: DATEN LADEN UND VERARBEITEN
// ==========================================

async function loadData() {
  try {
    // 1. Medaillen laden
    if(URL_MEDAILLEN.startsWith("http")) {
      const res = await fetch(URL_MEDAILLEN);
      const text = await res.text();
      processMedals(text);
      document.getElementById('loading-medals').classList.add('hidden'); // Ladekreis weg
    }

    // 2. Ablauf laden
    if(URL_ABLAUF.startsWith("http")) {
      const res = await fetch(URL_ABLAUF);
      const text = await res.text();
      processSchedule(text);
    }

  } catch (error) {
    console.error("Fehler beim Laden:", error);
  }
}

// Hilfsfunktion: CSV Text in Array umwandeln
function csvToArray(str) {
  const rows = str.trim().split('\n');
  return rows.map(row => {
    // Einfache CSV Trennung (berÃ¼cksichtigt keine Kommas innerhalb von Texten)
    return row.split(',').map(cell => cell.replace(/"/g, '').trim());
  });
}

function processMedals(csvText) {
  const rows = csvToArray(csvText);
  // Wir nehmen an: Zeile 1 ist Header. Ab Zeile 2 kommen Daten.
  // Spalten-Reihenfolge im Sheet muss sein: Teamname, Gold, Silber, Bronze
  
  const teams = [];
  
  // Start bei Index 1 (Index 0 ist die Ãœberschrift)
  for (let i = 1; i < rows.length; i++) {
    const cols = rows[i];
    if (cols.length < 4) continue; // Leere Zeilen Ã¼berspringen

    const name = cols[0];
    const gold = parseInt(cols[1]) || 0;
    const silver = parseInt(cols[2]) || 0;
    const bronze = parseInt(cols[3]) || 0;

    // Farbe bestimmen (sucht nach SchlÃ¼sselwÃ¶rtern im Namen)
    let cssClass = 'bg-gray-700 text-white'; // Fallback
    const nameLower = name.toLowerCase();
    
    for (const key in colorMap) {
      if (nameLower.includes(key)) {
        cssClass = colorMap[key];
        break; // Gefunden
      }
    }
