<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Kinderfreizeit Olympiade ‚Äì Live-Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Kleiner Kniff f√ºr Flaggen-Bilder, damit sie immer sch√∂n rund/eckig passen */
    .team-flag {
      width: 3rem;
      height: 3rem;
      object-fit: cover;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
    }
    @media (min-width: 768px) {
      .team-flag { width: 5rem; height: 5rem; font-size: 3.5rem; }
    }
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen font-sans">

<div class="flex flex-col md:flex-row min-h-screen relative">
    
  <div id="clock" class="absolute top-4 right-4 text-2xl md:text-4xl font-mono bg-black/60 px-6 py-3 rounded-xl shadow-lg z-20 border border-gray-700">
    00:00:00
  </div>

  <div class="w-full md:w-1/2 p-4 md:p-12 flex flex-col justify-center border-b md:border-b-0 md:border-r border-gray-700">
    <h1 class="text-3xl md:text-6xl font-extrabold mb-8 md:mb-12 text-center pt-12 md:pt-0 tracking-tight">
      üèÖ Medaillenspiegel
    </h1>
    
    <div id="scoreboard" class="space-y-4 md:space-y-6 w-full max-w-md md:max-w-3xl mx-auto">
      <p class="text-center animate-pulse text-xl">Lade Medaillendaten...</p>
    </div>
  </div>

  <div class="w-full md:w-1/2 bg-gray-800 p-4 md:p-12 flex flex-col justify-center">
    <h2 class="text-3xl md:text-5xl font-bold mb-8 md:mb-12 text-center pt-8 md:pt-0 text-gray-200">
      üìÖ Tagesablauf
    </h2>
    
    <div id="schedule" class="space-y-4 md:space-y-8 text-xl md:text-3xl w-full max-w-md md:max-w-3xl mx-auto">
      <p class="text-center animate-pulse text-xl text-gray-400">Lade Zeitplan...</p>
    </div>
  </div>

</div>

<script>
// ==========================================
// üé® TEAM-DESIGN KONFIGURATION
// Hier kannst du Namen, Farben und Flaggen anpassen
// ==========================================
const TEAM_CONFIG = {
  "Blau":    { color: "bg-blue-600 text-white", flag: "üèÜ" },
  "Gelb":    { color: "bg-yellow-400 text-black", flag: "üèÜ" },
  "Schwarz": { color: "bg-gray-950 text-white border border-gray-600", flag: "üèÜ" },
  "Gr√ºn":    { color: "bg-green-600 text-white", flag: "üèÜ" },
  "Rot":     { color: "bg-red-600 text-white", flag: "üèÜ" },
  // Falls ein Teamname im Sheet nicht gefunden wird, nutzt er das hier:
  "Standard":     { color: "bg-gray-700 text-white", flag: "üèÖ" }
};

// URLs deiner Google Sheets (CSV)
const MEDAL_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTl8ONEJhICDqDwsal3S1JazhwpI80LhIDD3MdpDiW1T4MJlL8RzX9k4Pq703VY12qRJpzOeZcpD8ZV/pub?gid=0&single=true&output=csv';
const SCHEDULE_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTl8ONEJhICDqDwsal3S1JazhwpI80LhIDD3MdpDiW1T4MJlL8RzX9k4Pq703VY12qRJpzOeZcpD8ZV/pub?gid=1373310417&single=true&output=csv';

// ==========================================
// LOGIK (Ab hier nichts mehr √§ndern n√∂tig)
// ==========================================

function parseCSV(text) {
  return text.split('\n')
             .map(line => line.split(',').map(cell => cell.trim()))
             .filter(row => row.length > 1 && row[0] !== "");
}

async function updateDashboard() {
  try {
    // 1. MEDAILLEN DATEN LADEN
    const medalResponse = await fetch(MEDAL_CSV_URL);
    const medalText = await medalResponse.text();
    const medalRows = parseCSV(medalText).slice(1);

    const teams = medalRows.map(row => ({
      name: row[0],
      gold: parseInt(row[1]) || 0,
      silver: parseInt(row[2]) || 0,
      bronze: parseInt(row[3]) || 0
    }));

    // Sortieren (Gold > Silber > Bronze)
    teams.sort((a, b) => (b.gold - a.gold) || (b.silver - a.silver) || (b.bronze - a.bronze));

    const scoreboardContainer = document.getElementById('scoreboard');
    scoreboardContainer.innerHTML = teams.map((team, index) => {
      // Design-Daten aus der Konfiguration oben holen
      const config = TEAM_CONFIG[team.name] || TEAM_CONFIG["Standard"];
      
      // Pr√ºfen ob Flagge ein Emoji oder eine Bild-URL ist
      const flagContent = config.flag.startsWith('http') 
        ? `<img src="${config.flag}" class="team-flag rounded-lg">` 
        : `<div class="team-flag">${config.flag}</div>`;

      return `
        <div class="flex justify-between items-center ${config.color} rounded-2xl p-4 md:p-6 shadow-xl transition-all duration-500">
          <div class="flex items-center gap-4 md:gap-6">
            ${flagContent}
            <div>
              <span class="text-xs md:text-lg opacity-70 block font-mono">${index + 1}. Platz</span>
              <h2 class="text-xl md:text-4xl font-bold truncate leading-tight">${team.name}</h2>
            </div>
          </div>
          <div class="flex gap-3 md:gap-8 text-lg md:text-4xl font-black bg-black/20 px-4 py-2 md:px-6 md:py-4 rounded-2xl backdrop-blur-sm border border-white/10">
            <span title="Gold">ü•á ${team.gold}</span>
            <span title="Silber" class="opacity-90">ü•à ${team.silver}</span>
            <span title="Bronze" class="opacity-80">ü•â ${team.bronze}</span>
          </div>
        </div>
      `;
    }).join('');

    // 2. ZEITPLAN LADEN
    const scheduleResponse = await fetch(SCHEDULE_CSV_URL);
    const scheduleText = await scheduleResponse.text();
    const scheduleRows = parseCSV(scheduleText).slice(1);

    const scheduleContainer = document.getElementById('schedule');
    scheduleContainer.innerHTML = scheduleRows.map(row => `
      <div class="flex justify-between border-b border-gray-600 pb-3 md:pb-5 items-baseline">
        <span class="font-bold text-blue-400 tabular-nums">${row[0]}</span>
        <span class="text-gray-300 text-right ml-4">${row[1]}</span>
      </div>
    `).join('');

  } catch (error) {
    console.error("Fehler:", error);
  }
}

function updateClock() {
  document.getElementById('clock').innerText = new Date().toLocaleTimeString('de-DE');
}

updateDashboard();
updateClock();
setInterval(updateClock, 1000);
setInterval(updateDashboard, 30000); // Alle 30 Sek neu laden
</script>
</body>
</html>
